{% extends "base.html" %}
{% block title %}Expedientes{% endblock %}

{% block content %}
<div class="col-12">
  <div class="d-flex justify-content-between align-items-center mb-3">
    <h3 class="m-0">üìÅ Expedientes Registrados</h3>
    <a href="{% url 'casos:case_create' %}" class="btn btn-primary btn-sm">
      <i class="fa fa-plus me-1"></i> Nuevo Caso
    </a>
  </div>

  <div class="table-responsive stack-xs stack-tight" style="--stack-label-w: 140px;">
    <table class="table table-hover table-xs-compact align-middle shadow-sm">
      <thead class="table-light">
        <tr>
          <th>#</th>
          <th>Nro Expediente</th>
          <th>Caso</th>
          <th>Cliente Principal</th>
          <th>Estado</th>
          <th>Fecha Creaci√≥n</th>
          <th class="text-end">Acciones</th>
        </tr>
      </thead>
      <tbody>
        {% for exp in expedientes %}
        <tr>
          <td data-label="#">{{ forloop.counter }}</td>
          <td data-label="Nro Expediente" class="fw-semibold">
            <a href="{% url 'casos:expediente_timeline' exp.id %}" class="text-decoration-none">
              {{ exp.nroExpediente }}
            </a>
          </td>
          <td data-label="Caso">{{ exp.caso.nroCaso }}</td>
          <td data-label="Cliente Principal">{{ exp.caso.cliente_principal }}</td>
          <td data-label="Estado">
            <span class="badge {% if exp.estado == 'ABIERTO' %}bg-success{% else %}bg-secondary{% endif %}">
              {{ exp.estado }}
            </span>
          </td>
          <td data-label="Fecha">{{ exp.fechaCreacion|date:"d/m/Y" }}</td>
          <td class="text-end stack-actions">
            <!-- XS: solo iconos -->
            <a href="{% url 'casos:carpeta_list' exp.id %}" class="btn btn-outline-primary btn-sm d-inline d-sm-none" title="Carpetas">
              <i class="fa fa-folder-open"></i>
            </a>
            <a href="{% url 'casos:expediente_timeline' exp.id %}" class="btn btn-outline-secondary btn-sm d-inline d-sm-none" title="Timeline">
              <i class="fa fa-clock"></i>
            </a>

            <!-- SM+: iconos + texto -->
            <div class="btn-group d-none d-sm-inline-flex">
              <a href="{% url 'casos:carpeta_list' exp.id %}" class="btn btn-outline-primary btn-sm">
                <i class="fa fa-folder-open me-1"></i> Carpetas
              </a>
              <a href="{% url 'casos:expediente_timeline' exp.id %}" class="btn btn-outline-secondary btn-sm">
                <i class="fa fa-clock me-1"></i> Timeline
              </a>
            </div>
          </td>
        </tr>
        {% empty %}
        <tr><td colspan="7" class="text-center text-muted py-3">No hay expedientes registrados.</td></tr>
        {% endfor %}
      </tbody>
    </table>
  </div>
</div>
{% endblock %}
