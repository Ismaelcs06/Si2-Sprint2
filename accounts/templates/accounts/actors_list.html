{% extends "base.html" %}
{% block title %}Actores{% endblock %}

{% block content %}
<div class="col-12">
  <div class="d-flex justify-content-between align-items-center mb-3">
    <h3 class="m-0">Lista de Actores</h3>
  </div>

  <!-- Filtro por tipo -->
  <form method="get" class="mb-4">
    <div class="row g-2 align-items-center">
      <div class="col-auto">
        <label class="form-label mb-0">Filtrar por tipo:</label>
      </div>
      <div class="col-auto">
        
        <select name="tipo" class="form-select form-select-sm" onchange="this.form.submit()">
          <option value="" {% if not tipo %}selected{% endif %}>Todos</option>
          <option value="ABO"   {% if tipo == 'ABO' %}selected{% endif %}>Abogado</option>
          <option value="CLI"   {% if tipo == 'CLI' %}selected{% endif %}>Cliente</option>
          <option value="ASI" {% if tipo == 'ASI' %}selected{% endif %}>Asistente</option>
        </select>
      </div>
    </div>
  </form>

  <!-- Tabla -> tarjetas en móvil -->
  <div class="table-responsive stack-xs table-xs-compact">
    <table class="table table-sm table-hover align-middle shadow-sm">
      <thead class="table-light">
        <tr>
          <th>Tipo</th>
          <th>Nombre completo</th>
          <th>CI</th>
          <th>Teléfono</th>
          <th>Usuario</th>
          <th>Estado</th>
          <th>Datos específicos</th>
        </tr>
      </thead>
      <tbody>
        {% for item in actores_data %}
          {% with a=item.actor %}
          <tr>
            <td data-label="Tipo">{{ a.tipoActor }}</td>

            <td class="td-wrap" data-label="Nombre completo">
              {{ a.nombres }} {{ a.apellidoPaterno }} {{ a.apellidoMaterno }}
            </td>

            <td class="td-nowrap" data-label="CI">{{ a.ci }}</td>

            <td class="td-nowrap" data-label="Teléfono">
              {{ a.telefono|default:"—" }}
            </td>

            <td data-label="Usuario">
              {% if a.usuario %}
                {{ a.usuario.username }}
              {% else %}
                <span class="text-muted">—</span>
              {% endif %}
            </td>

            <td data-label="Estado">
              {% if a.estadoActor == "ACTIVO" %}
                <span class="badge bg-success">{{ a.estadoActor }}</span>
              {% else %}
                <span class="badge bg-secondary">{{ a.estadoActor }}</span>
              {% endif %}
            </td>

            <td data-label="Datos específicos">
              {% if item.info_completa %}
                <span class="badge bg-success">Completo</span>
              {% else %}
                <!-- XS: icon-only, SM+: texto -->
                <a href="{{ item.enlace_completar }}"
                   class="btn btn-outline-warning btn-sm d-inline d-sm-none"
                   title="Completar datos">
                  <i class="fa fa-edit"></i>
                </a>
                <a href="{{ item.enlace_completar }}"
                   class="btn btn-outline-warning btn-sm d-none d-sm-inline-flex">
                  <i class="fa fa-edit me-1"></i> Completar datos
                </a>
              {% endif %}
            </td>
          </tr>
          {% endwith %}
        {% empty %}
          <tr>
            <td colspan="7" class="text-center text-muted py-3">
              No se encontraron actores.
            </td>
          </tr>
        {% endfor %}
      </tbody>
    </table>
  </div>
</div>
{% endblock %}
