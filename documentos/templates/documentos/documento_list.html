{% extends 'base.html' %}
{% block title %}Lista de Documentos{% endblock %}

{% block content %}
<div class="table-responsive stack-xs stack-tight" style="--stack-label-w: 120px;">
  <h3 class="mb-3">Lista de Documentos</h3>
  <table class="table table-striped table-hover align-middle table-xs-compact documentos-table">
    <thead class="table-dark">
      <tr>
        <th>#</th>
        <th>Nombre</th>
        <th class="col-hide-xxs">Tipo</th>              <!-- oculto en â‰¤360 -->
        <th class="col-hide-sm">Etapa Procesal</th>     <!-- oculto en <768 -->
        <th class="col-hide-sm">Carpeta</th>            <!-- oculto en <768 -->
        <th>Fecha</th>
        <th class="col-hide-sm">Archivo</th>            <!-- oculto en <768 -->
        <th class="text-center">Acciones</th>
      </tr>
    </thead>
    <tbody>
      {% for doc in documentos %}
      <tr>
        <td class="td-nowrap" data-label="#"> {{ forloop.counter }} </td>
        <td class="td-wrap td-truncate td-truncate-xs" data-label="Nombre">
          {{ doc.nombreDocumento }}
        </td>
        <td class="col-hide-xxs" data-label="Tipo">{{ doc.tipoDocumento.nombre }}</td>
        <td class="col-hide-sm" data-label="Etapa">{{ doc.etapaProcesal.nombre|default:"-" }}</td>
        <td class="col-hide-sm td-truncate" data-label="Carpeta">{{ doc.carpeta.nombre }}</td>
        <td class="td-nowrap" data-label="Fecha">{{ doc.fechaDoc|date:"d/m/Y" }}</td>

        <td class="col-hide-sm" data-label="Archivo">
          {% if doc.rutaDocumento %}
            <!-- SM+: texto + icono -->
            <a href="{{ doc.rutaDocumento.url }}" target="_blank"
               class="btn btn-sm btn-outline-success d-none d-sm-inline-flex">
              <i class="fa fa-file-pdf me-1"></i> Ver
            </a>
            <!-- XS: solo icono -->
            <a href="{{ doc.rutaDocumento.url }}" target="_blank"
               class="btn btn-sm btn-outline-success d-inline d-sm-none" title="Ver">
              <i class="fa fa-file-pdf"></i>
            </a>
          {% else %}
            <span class="text-muted">No adjunto</span>
          {% endif %}
        </td>

        <td class="text-center stack-actions" data-label="Acciones">
          <!-- XS: icon-only -->
          <a href="{% url 'documentos:version_list' doc.id %}"
             class="btn btn-outline-info btn-sm d-inline d-sm-none" title="Ver versiones">
            <i class="fa fa-code-branch"></i>
          </a>
          <a href="{% url 'documentos:documento_create' %}?editar={{ doc.id }}"
             class="btn btn-outline-warning btn-sm d-inline d-sm-none" title="Editar">
            <i class="fa fa-edit"></i>
          </a>

          <!-- SM+: texto + icono -->
          <a href="{% url 'documentos:version_list' doc.id %}"
             class="btn btn-outline-info btn-sm d-none d-sm-inline-flex">
            <i class="fa fa-code-branch me-1"></i> Ver versiones
          </a>
          <a href="{% url 'documentos:documento_create' %}?editar={{ doc.id }}"
             class="btn btn-outline-warning btn-sm d-none d-sm-inline-flex">
            <i class="fa fa-edit me-1"></i> Editar
          </a>
        </td>
      </tr>
      {% empty %}
      <tr>
        <td colspan="8" class="text-center text-muted py-3">No hay documentos registrados.</td>
      </tr>
      {% endfor %}
    </tbody>
  </table>
</div>

{% endblock %}
